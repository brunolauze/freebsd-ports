--- configure.orig	2013-12-24 11:01:33.508546033 -0600
+++ configure	2013-12-24 11:07:59.409223312 -0600
@@ -603,6 +603,9 @@
 #ifdef HAVE_SYS_TYPES_H
 # include <sys/types.h>
 #endif
+#ifdef HAVE_SYS_PARAM_H
+# include <sys/param.h>
+#endif
 #ifdef HAVE_SYS_STAT_H
 # include <sys/stat.h>
 #endif
@@ -4690,7 +4693,7 @@
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
        ${MAKE-make} -s -f confmf > /dev/null 2>&1; then
       # icc doesn't choke on unknown options, it will just issue warnings
-      # or remarks (even with -Werror).  So we grep stderr for any message
+      # or remarks (even with ).  So we grep stderr for any message
       # that says an option was ignored or not supported.
       # When given -MP, icc 7.0 and 7.1 complain thusly:
       #   icc: Command line warning: ignoring option '-M'; no argument required
@@ -5966,7 +5969,7 @@
 fi
 
 GLIB_RUNTIME_LIBDIR="$with_runtime_libdir"
-ABS_GLIB_RUNTIME_LIBDIR="`readlink -f $libdir/$with_runtime_libdir`"
+ABS_GLIB_RUNTIME_LIBDIR="`readlink $libdir/$with_runtime_libdir`"
 
 
  if test "x$with_runtime_libdir" != "x"; then
@@ -6434,7 +6437,7 @@
        grep $am__obj sub/conftest.Po > /dev/null 2>&1 &&
        ${MAKE-make} -s -f confmf > /dev/null 2>&1; then
       # icc doesn't choke on unknown options, it will just issue warnings
-      # or remarks (even with -Werror).  So we grep stderr for any message
+      # or remarks (even with ).  So we grep stderr for any message
       # that says an option was ignored or not supported.
       # When given -MP, icc 7.0 and 7.1 complain thusly:
       #   icc: Command line warning: ignoring option '-M'; no argument required
@@ -7497,13 +7500,12 @@
 
       # Check if we have GNU libiconv
       if test $found_iconv = "no"; then
-	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for libiconv_open in -liconv" >&5
-$as_echo_n "checking for libiconv_open in -liconv... " >&6; }
+	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for libiconv_open" >&5
+$as_echo_n "checking for libiconv_open... " >&6; }
 if ${ac_cv_lib_iconv_libiconv_open+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-liconv  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@ -7540,13 +7542,12 @@
       fi
       # Check if we have a iconv in -liconv, possibly from vendor
       if test $found_iconv = "no"; then
-	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for iconv_open in -liconv" >&5
-$as_echo_n "checking for iconv_open in -liconv... " >&6; }
+	{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for iconv_open" >&5
+$as_echo_n "checking for iconv_open... " >&6; }
 if ${ac_cv_lib_iconv_iconv_open+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-liconv  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@ -7590,13 +7591,12 @@
 
       ;;
     gnu|yes)
-      { $as_echo "$as_me:${as_lineno-$LINENO}: checking for libiconv_open in -liconv" >&5
-$as_echo_n "checking for libiconv_open in -liconv... " >&6; }
+      { $as_echo "$as_me:${as_lineno-$LINENO}: checking for libiconv_open" >&5
+$as_echo_n "checking for libiconv_open... " >&6; }
 if ${ac_cv_lib_iconv_libiconv_open+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-liconv  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@ -7632,13 +7632,12 @@
 
       ;;
     native)
-      { $as_echo "$as_me:${as_lineno-$LINENO}: checking for iconv_open in -liconv" >&5
-$as_echo_n "checking for iconv_open in -liconv... " >&6; }
+      { $as_echo "$as_me:${as_lineno-$LINENO}: checking for iconv_open" >&5
+$as_echo_n "checking for iconv_open... " >&6; }
 if ${ac_cv_lib_iconv_iconv_open+:} false; then :
   $as_echo_n "(cached) " >&6
 else
   ac_check_lib_save_LIBS=$LIBS
-LIBS="-liconv  $LIBS"
 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 
@@ -8673,6 +8672,7 @@
     ;;
   native)
 
+ICONV_LIBS=""
 $as_echo "#define USE_LIBICONV_NATIVE 1" >>confdefs.h
 
     ;;
@@ -23255,7 +23255,7 @@
 fi
 done
 
-for ac_func in lchmod lchown fchmod fchown utimes getresuid
+for ac_func in lchmod lchown fchmod fchown utimes getresuid sysctlbyname
 do :
   as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
 ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
@@ -25306,10 +25306,10 @@
   ac_fn_c_check_header_mongrel "$LINENO" "sys/inotify.h" "ac_cv_header_sys_inotify_h" "$ac_includes_default"
 if test "x$ac_cv_header_sys_inotify_h" = xyes; then :
   cat >>confdefs.h <<_ACEOF
-#define HAVE_SYS_INOTIFY_H 1
+
 _ACEOF
 
-	inotify_support=yes
+	inotify_support=no
 	for ac_func in inotify_init1
 do :
   ac_fn_c_check_func "$LINENO" "inotify_init1" "ac_cv_func_inotify_init1"
@@ -26760,10 +26760,10 @@
   *android*)
     G_THREAD_LIBS_FOR_GTHREAD="$G_THREAD_LIBS"
     ;;
-  *-*-freebsd*|*-*-linux*)
+  *-*-linux*)
     G_THREAD_LIBS_FOR_GTHREAD="`echo $G_THREAD_LIBS | sed s/-pthread/-lpthread/`"
     ;;
-  *-*-openbsd*)
+  *-*-freebsd*|*-*-openbsd*)
     LDFLAGS="$LDFLAGS -pthread"
     ;;
   *)
@@ -28878,10 +28878,10 @@
 
 
   for flag in \
-   -Wall -Wstrict-prototypes -Werror=declaration-after-statement \
-   -Werror=missing-prototypes -Werror=implicit-function-declaration \
-   -Werror=pointer-arith -Werror=init-self -Werror=format-security \
-   -Werror=format=2 -Werror=missing-include-dirs; do
+   -Wall -Wstrict-prototypes =declaration-after-statement \
+   =missing-prototypes -Werror=implicit-function-declaration \
+   =pointer-arith -Werror=init-self -Werror=format-security \
+   =format=2 -Werror=missing-include-dirs; do
 
   { $as_echo "$as_me:${as_lineno-$LINENO}: checking if $CC supports flag $flag in envvar CFLAGS" >&5
 $as_echo_n "checking if $CC supports flag $flag in envvar CFLAGS... " >&6; }
@@ -28889,7 +28889,7 @@
   $as_echo_n "(cached) " >&6
 else
   eval "cc_save_CFLAGS='${CFLAGS}'"
-		  eval "CFLAGS='-Werror $flag'"
+		  eval "CFLAGS=' $flag'"
 		  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
 /* end confdefs.h.  */
 int a = 0; int main(void) { return a; }
